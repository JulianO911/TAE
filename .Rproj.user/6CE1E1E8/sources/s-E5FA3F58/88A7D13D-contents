---
title: "Trabajo individual"
author: "Deivid Zhang Figueroa"
date: "7/11/2020"
output:
  html_document:
    toc: yes
    css: estilo2.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE)
```

# Librerías
```{r}
library(tidyverse)
library(sf)
library(summarytools)
```

```{r}
load("accidentalidad_med.RData")
```

# Sección donde se explica detalladamete las variables a usar

## Se agrupa las variables Diseño.Vía y Nivel.de.gravedad para su posterior uso
Aquí se agrupa las variables Diseño.Vía y Nivel.de.gravedad, esto con el propósito de analizar número de accidentes en cada nivel de gravedad para cada zona.
```{r}
acc_z_n <- acc_med2 %>% group_by(ZONA,Nivel.de.gravedad) %>% summarise(num_accidentes=n()) %>% arrange()
```
## Se agrupa las variables Diseño.Vía y Nivel.de.gravedad para su posterior uso
Aquí se agrupa las variables Diseño.Vía y Nivel.de.gravedad, con el propósito de analizar la cantidad de accidentes para cada tipo de vía, con su respectivo nivel de gravedad.
```{r}
acc_grav <- acc_med2 %>% group_by(Diseño.Vía,Nivel.de.gravedad) %>% summarise(num_accidentes =n()) %>% arrange()
```
## Se agrupa las variables AÑO_ACCIDENTE,Nivel.de.gravedad para su posterior uso
Aquí se agrupa las variables AÑO_ACCIDENTE y Nivel.de.gravedad, luego se suma la cantidad de accidentes por nivel de gravedad.
```{r}
acc_niv <- acc_med2 %>% group_by(AÑO_ACCIDENTE,Nivel.de.gravedad) %>% summarise(num_accidentes = n()) %>% arrange()
```


## Se agrupa la variable Dia.de.la.semana para su posterior uso 
Aquí se agrupa la variable Dia.de.la.semana, luego se suma la cantidad de accidentes que hay en día de la semana, esto se hace con el fin de saber cuántos accidentes hay en un día específico.
```{r}
acc_dia <- acc_med2 %>% group_by(Dia.de.la.semana) %>% summarise(num_accidentes = n()) %>% arrange()
```
## Se agrupa la variable Hora.del.día para su posterior uso
Aquí se agrupa la variable Hora.del.día, luego se suma la cantidad de accidentes que hay en cada hora, esto se hace con el fin de saber cuántos accidentes hay en una franja horaria en específico.
```{r}
acc_hora <- acc_med2 %>% group_by(Hora.del.día,AÑO_ACCIDENTE) %>% summarise(num_accidentes = n()) %>% arrange()
```






# Sección de preguntas, respuestas, gráficas, análisis, conclusiones y recomendaciones.

## 1.¿La cantidad de accidentes con motos en medellín han aumentado con el pasar del tiempo?
- Se puede observar que 14 de las 37 zonas casi no ocurren accidentes.
- En la comuna 10 ocurren la mayoría de los accidentes con motos.
- Muchas de las comunas registran cantidad de accidentes relativamente similares.

```{r fig.width=25, fig.height=60}
ggplot(acc_z_n, aes(fill=ZONA, y=num_accidentes, x=Nivel.de.gravedad)) + 
    geom_bar(position="stack", stat="identity") +
  facet_wrap(~ZONA)
```

## 2.¿Cúal es el nivel de gravedad más frecuente en cada año?
Se puede observar claramente que para el año 2020, la frecuencia de todos los niveles de gravedad es la más baja, y en todos los años para el nivel de gravedad 3 tienen muy poca fecuencia, además el nivel de gravedad 2 son las que ocupan la mayoría en todos los años.

```{r}
ggplot(acc_niv, aes(x=Nivel.de.gravedad, y=num_accidentes, color=AÑO_ACCIDENTE)) +
  geom_bar(stat="identity",position=position_dodge()) +
  ggtitle ("Frecuencia nivel de gravedad por año") +
  labs(x = "Nivel de gravedad",y = "Frecuencia")
```











## 3.¿Qué día de la semana se presenta mayor accidentalidad?
Se puede observar que el día lunes es el día de la semana con menos accidentes, mientras que el día sábado tiene la mayor cantidad de accidente.

```{r}
ggplot(acc_dia, aes(x = Dia.de.la.semana, y = num_accidentes))+
  geom_col(aes(fill = Dia.de.la.semana), width = 0.7) +
  scale_fill_manual(values = c("deepskyblue","deepskyblue2","dodgerblue","dodgerblue1","dodgerblue2","dodgerblue3","dodgerblue4")) +
  coord_flip() + 
  ggtitle ("Número de accidentes por día de la semana") +
  labs(x = "Día de la semana",y = "Número de accidentes")
  
```

## 4.¿A qué hora del día de cada año se presenta mayor accidentalidad?
Se puede observar que en la franja horaria de 0-5 de la madrugada se presenta la menor cantidad de accidentes en todos los años, ahora en el año 2015, 2018 y 2020, en la franja horaria de 10-15, es donde se encuentra la mayor cantidad de accidentes, mientras que en el año 2016, 2017 y 2019, en la franja horaria de 15-20, es donde se encuentra la mayor cantidad de accidentes.

```{r fig.height=6, fig.width=6}
ggplot(acc_hora, mapping = aes(x = Hora.del.día)) + geom_histogram(color = "black", fill = "orange", breaks = seq(0, 24, by = 4)) + 
  facet_grid(. ~ AÑO_ACCIDENTE) +  theme_bw() + ggtitle("Cantidad de accidentes por hora del día") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "Hora del día",y = "Número de accidentes") +
  facet_wrap(~AÑO_ACCIDENTE)
```


## 5.¿Para cada nivel de gravedad, cuál es el tipo de vía donde hay más número de accidentes para cada nivel?
Se puede ver claramente que la mayoría de los diseños de vía donde ocurren los accidentes con motos, el nivel de gravedad 2 tiene más números de accidentes, más específicamente en "Tramo de vía", es donde ocupan la gran mayoría de accidentes.

```{r fig.width=6, fig.height=6}
ggplot(acc_grav, aes(fill=Diseño.Vía, y=num_accidentes, x=Nivel.de.gravedad)) + 
    geom_bar(position="stack", stat="identity") +
  facet_wrap(~Diseño.Vía)
```


## Conclusiones
- Se es necesario hacer un análisis detallado año por año de la accidentalidad, debido que la accidentalidad no tiene un patrón específico en todos los años, por ejemplo, en un año específico con una franja horaria específica puede haber una mayor cantidad de accidentes, pero en otro año, en la misma franja horaria ya no es la mayoría, sino en otra franja horaria.
- Los fines de semana se presenta bastante accidentalidad, sobre todo el día sábado, esto tal vez es porque la mayoría de la gente no trabajan y salen de rumba ese día.
- La accidentalidad en motos han aumentado con el pasar del tiempo, esto lleva pensar que la gente no son tan responsables o precavidos al momento de manejar una moto.

## Recomendaciones
- En los lugares donde ocurren más accidentes, sería bueno colocar más señalizaciones para así disminuir la cantidad de accidentes en esos lugares.
- Sería bueno alertar o dar a conocer a los motociclistas las franjas horarias donde hay más accidentes con motos, para así manejar con más precaución.
- En los fines de semana manejar con más precaución.








